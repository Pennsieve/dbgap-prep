package ds

import (
	"github.com/pennsieve/dbgap-prep/internal/dbgap/dd"
	"github.com/pennsieve/dbgap-prep/internal/dbgap/ds"
	"github.com/pennsieve/dbgap-prep/internal/samples"
	"github.com/stretchr/testify/assert"
	"github.com/stretchr/testify/require"
	"github.com/xuri/excelize/v2"
	"testing"
)

func TestToRow(t *testing.T) {
	variableNames := dd.VariableNames(variables)
	for _, consentedSample := range consentedSubjectSamples {
		row := ToRow(variableNames, consentedSample)
		assert.Len(t, row, len(variableNames))
		for i, variableName := range variableNames {
			if variableName == dd.SampleIDVar.Name {
				assert.Equal(t, consentedSample.ID, row[i])
			} else {
				assert.Equal(t, consentedSample.Values[variableName], row[i])
			}
		}

	}
}

func TestWrite(t *testing.T) {
	writer := ds.NewXLSXWriter(t.TempDir(), DefaultFileNameBase)

	require.NoError(t, Write(writer, variables, consentedSubjectSamples))

	actualFile, err := excelize.OpenFile(writer.Path())
	require.NoError(t, err)
	defer func() {
		assert.NoError(t, actualFile.Close())
	}()

	records, err := actualFile.GetRows("Sheet1")
	require.NoError(t, err)

	// add one for the header
	assert.Len(t, records, expectedDataRowsCount+1)

	variableNames := dd.VariableNames(variables)
	assert.Equal(t, variableNames, records[0])
	assert.NotEqual(t, variableNames, records[1])
}

var variables = []dd.Variable{dd.Variable{Name: "SAMPLE_ID", Description: "Sample ID", Type: "string", Attributes: map[dd.Column]interface{}{"UNIQUEKEY": "X"}, Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "BODY_SITE", Description: "Body site where sample was collected", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "ANALYTE_TYPE", Description: "Analyte type", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "IS_TUMOR", Description: "Tumor status", Type: "encoded value", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue{dd.EncodedValue{Value: "Y", Meaning: "Is tumor"}, dd.EncodedValue{Value: "N", Meaning: "Is not a tumor"}, dd.EncodedValue{Value: "UNK", Meaning: "Tumor status unknown"}}}, dd.Variable{Name: "was derived from", Description: "was derived from", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "pool id", Description: "pool id", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "sample experimental group", Description: "sample experimental group", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "sample type", Description: "sample type", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "sample anatomical location", Description: "sample anatomical location", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "also in dataset", Description: "also in dataset", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "member of", Description: "member of", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "metadata only", Description: "metadata only", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "number of directly derived samples", Description: "number of directly derived samples", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "laboratory internal id", Description: "laboratory internal id", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "date of derivation", Description: "date of derivation", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "experimental log file path", Description: "experimental log file path", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "reference atlas", Description: "reference atlas", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "pathology", Description: "pathology", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "laterality", Description: "laterality", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "cell type", Description: "cell type", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "plane of section", Description: "plane of section", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "protocol title", Description: "protocol title", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "protocol url or doi", Description: "protocol url or doi", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "RNA concentration", Description: "RNA concentration", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "RNA concentration method", Description: "RNA concentration method", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "RNA purity", Description: "RNA purity", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "RNA quality", Description: "RNA quality", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "RNA quality method", Description: "RNA quality method", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "amputation", Description: "amputation", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "body temp", Description: "body temp", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "collection institution", Description: "collection institution", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "cross clamp (first)", Description: "cross clamp (first)", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "cross clamp (last)", Description: "cross clamp (last)", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "cross clamp time", Description: "cross clamp time", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "donor status", Description: "donor status", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "fixation method", Description: "fixation method", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "fixation temp", Description: "fixation temp", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "fixation time", Description: "fixation time", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "freeze thaw cycles", Description: "freeze thaw cycles", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "freezing method", Description: "freezing method", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "freezing temp", Description: "freezing temp", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "incision time", Description: "incision time", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "ischemic time", Description: "ischemic time", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "post-mortem interval", Description: "post-mortem interval", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "protein concentration", Description: "protein concentration", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "protein concentration method", Description: "protein concentration method", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "sample collection site", Description: "sample collection site", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "storage temp", Description: "storage temp", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "time of sample collection", Description: "time of sample collection", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "nCells", Description: "nCells", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "nFeature_RNA", Description: "nFeature_RNA", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "nCount_RNA", Description: "nCount_RNA", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "nFeature_ATAC", Description: "nFeature_ATAC", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}, dd.Variable{Name: "nCount_ATAC", Description: "nCount_ATAC", Type: "string", Attributes: map[dd.Column]interface{}(nil), Values: []dd.EncodedValue(nil)}}

var consentedSubjectSamples = []samples.Sample{
	samples.Sample{ID: "sam-hSG-lib-4", SubjectID: "sub-hSG-Female-1", Values: map[string]string{"RNA concentration": "", "RNA concentration method": "", "RNA purity": "", "RNA quality": "", "RNA quality method": "", "also in dataset": "", "amputation": "not-asked", "body temp": "", "cell type": "", "collection institution": "WashU", "cross clamp (first)": "", "cross clamp (last)": "", "cross clamp time": "", "date of derivation": "", "donor status": "", "experimental log file path": "", "fixation method": "Fresh Frozen", "fixation temp": "-170", "fixation time": "", "freeze thaw cycles": "", "freezing method": "", "freezing temp": "", "incision time": "", "ischemic time": "", "laboratory internal id": "hSG-4", "laterality": "", "member of": "", "metadata only": "TRUE", "nCells": "6882", "nCount_ATAC": "4880.5233943621", "nCount_RNA": "3662.77651845394", "nFeature_ATAC": "2382.46875908166", "nFeature_RNA": "1776.60665504214", "number of directly derived samples": "", "pathology": "", "plane of section": "", "pool id": "", "post-mortem interval": "", "protein concentration": "", "protein concentration method": "", "protocol title": "", "protocol url or doi": "", "reference atlas": "", "sample anatomical location": "sympathetic ganglion", "sample collection site": "", "sample experimental group": "", "sample type": "tissue", "storage temp": "-80", "time of sample collection": "", "was derived from": ""}},
	samples.Sample{ID: "sam-hSG-lib-7", SubjectID: "sub-hSG-Female-2", Values: map[string]string{"RNA concentration": "", "RNA concentration method": "", "RNA purity": "", "RNA quality": "", "RNA quality method": "", "also in dataset": "", "amputation": "not-asked", "body temp": "", "cell type": "", "collection institution": "WashU", "cross clamp (first)": "", "cross clamp (last)": "", "cross clamp time": "", "date of derivation": "", "donor status": "", "experimental log file path": "", "fixation method": "Fresh Frozen", "fixation temp": "-170", "fixation time": "", "freeze thaw cycles": "", "freezing method": "", "freezing temp": "", "incision time": "", "ischemic time": "", "laboratory internal id": "hSG-7", "laterality": "", "member of": "", "metadata only": "TRUE", "nCells": "5951", "nCount_ATAC": "12078.1188035624", "nCount_RNA": "3806.49000168039", "nFeature_ATAC": "5239.86304822719", "nFeature_RNA": "1739.59519408503", "number of directly derived samples": "", "pathology": "", "plane of section": "", "pool id": "", "post-mortem interval": "", "protein concentration": "", "protein concentration method": "", "protocol title": "", "protocol url or doi": "", "reference atlas": "", "sample anatomical location": "sympathetic ganglion", "sample collection site": "", "sample experimental group": "", "sample type": "tissue", "storage temp": "-80", "time of sample collection": "", "was derived from": ""}}, samples.Sample{ID: "sam-hSG-lib-8", SubjectID: "sub-hSG-Female-2", Values: map[string]string{"RNA concentration": "", "RNA concentration method": "", "RNA purity": "", "RNA quality": "", "RNA quality method": "", "also in dataset": "", "amputation": "not-asked", "body temp": "", "cell type": "", "collection institution": "WashU", "cross clamp (first)": "", "cross clamp (last)": "", "cross clamp time": "", "date of derivation": "", "donor status": "", "experimental log file path": "", "fixation method": "Fresh Frozen", "fixation temp": "-170", "fixation time": "", "freeze thaw cycles": "", "freezing method": "", "freezing temp": "", "incision time": "", "ischemic time": "", "laboratory internal id": "hSG-8", "laterality": "", "member of": "", "metadata only": "TRUE", "nCells": "5678", "nCount_ATAC": "12090.1377245509", "nCount_RNA": "3724.34114124692", "nFeature_ATAC": "5230.64864388869", "nFeature_RNA": "1712.71556886227", "number of directly derived samples": "", "pathology": "", "plane of section": "", "pool id": "", "post-mortem interval": "", "protein concentration": "", "protein concentration method": "", "protocol title": "", "protocol url or doi": "", "reference atlas": "", "sample anatomical location": "sympathetic ganglion", "sample collection site": "", "sample experimental group": "", "sample type": "tissue", "storage temp": "-80", "time of sample collection": "", "was derived from": ""}},
	samples.Sample{ID: "sam-D-20210810A-SG4-CURLS-02", SubjectID: "sub-hSG-Male-1", Values: map[string]string{"RNA concentration": "", "RNA concentration method": "", "RNA purity": "", "RNA quality": "", "RNA quality method": "", "also in dataset": "", "amputation": "", "body temp": "", "cell type": "", "collection institution": "", "cross clamp (first)": "", "cross clamp (last)": "", "cross clamp time": "", "date of derivation": "", "donor status": "", "experimental log file path": "", "fixation method": "", "fixation temp": "", "fixation time": "", "freeze thaw cycles": "", "freezing method": "", "freezing temp": "", "incision time": "", "ischemic time": "", "laboratory internal id": "", "laterality": "", "member of": "", "metadata only": "TRUE", "nCells": "", "nCount_ATAC": "", "nCount_RNA": "", "nFeature_ATAC": "", "nFeature_RNA": "", "number of directly derived samples": "", "pathology": "", "plane of section": "", "pool id": "", "post-mortem interval": "", "protein concentration": "", "protein concentration method": "", "protocol title": "", "protocol url or doi": "", "reference atlas": "", "sample anatomical location": "sympathetic ganglion", "sample collection site": "", "sample experimental group": "", "sample type": "tissue", "storage temp": "", "time of sample collection": "", "was derived from": ""}}, samples.Sample{ID: "sam-hSG-lib-2", SubjectID: "sub-hSG-Male-1", Values: map[string]string{"RNA concentration": "", "RNA concentration method": "", "RNA purity": "", "RNA quality": "", "RNA quality method": "", "also in dataset": "", "amputation": "not-asked", "body temp": "", "cell type": "", "collection institution": "WashU", "cross clamp (first)": "", "cross clamp (last)": "", "cross clamp time": "", "date of derivation": "", "donor status": "", "experimental log file path": "", "fixation method": "Fresh Frozen", "fixation temp": "-170", "fixation time": "", "freeze thaw cycles": "", "freezing method": "", "freezing temp": "", "incision time": "", "ischemic time": "", "laboratory internal id": "hSG-2", "laterality": "", "member of": "", "metadata only": "TRUE", "nCells": "8189", "nCount_ATAC": "6925.28257418488", "nCount_RNA": "4138.48540725363", "nFeature_ATAC": "3266.53730614239", "nFeature_RNA": "1986.50799853462", "number of directly derived samples": "", "pathology": "", "plane of section": "", "pool id": "", "post-mortem interval": "", "protein concentration": "", "protein concentration method": "", "protocol title": "", "protocol url or doi": "", "reference atlas": "", "sample anatomical location": "sympathetic ganglion", "sample collection site": "", "sample experimental group": "", "sample type": "tissue", "storage temp": "-80", "time of sample collection": "", "was derived from": ""}},
	samples.Sample{ID: "sam-hSG-lib-3", SubjectID: "sub-hSG-Male-2", Values: map[string]string{"RNA concentration": "", "RNA concentration method": "", "RNA purity": "", "RNA quality": "", "RNA quality method": "", "also in dataset": "", "amputation": "not-asked", "body temp": "", "cell type": "", "collection institution": "WashU", "cross clamp (first)": "", "cross clamp (last)": "", "cross clamp time": "", "date of derivation": "", "donor status": "", "experimental log file path": "", "fixation method": "Fresh Frozen", "fixation temp": "-170", "fixation time": "", "freeze thaw cycles": "", "freezing method": "", "freezing temp": "", "incision time": "", "ischemic time": "", "laboratory internal id": "hSG-3", "laterality": "", "member of": "", "metadata only": "TRUE", "nCells": "6465", "nCount_ATAC": "3825.2909512761", "nCount_RNA": "3426.73302397525", "nFeature_ATAC": "1941.78128383604", "nFeature_RNA": "1741.47981438515", "number of directly derived samples": "", "pathology": "", "plane of section": "", "pool id": "", "post-mortem interval": "", "protein concentration": "", "protein concentration method": "", "protocol title": "", "protocol url or doi": "", "reference atlas": "", "sample anatomical location": "sympathetic ganglion", "sample collection site": "", "sample experimental group": "", "sample type": "tissue", "storage temp": "-80", "time of sample collection": "", "was derived from": ""}},
	samples.Sample{ID: "sam-hSG-lib-5", SubjectID: "sub-hSG-Male-3", Values: map[string]string{"RNA concentration": "", "RNA concentration method": "", "RNA purity": "", "RNA quality": "", "RNA quality method": "", "also in dataset": "", "amputation": "not-asked", "body temp": "", "cell type": "", "collection institution": "WashU", "cross clamp (first)": "", "cross clamp (last)": "", "cross clamp time": "", "date of derivation": "", "donor status": "", "experimental log file path": "", "fixation method": "Fresh Frozen", "fixation temp": "-170", "fixation time": "", "freeze thaw cycles": "", "freezing method": "", "freezing temp": "", "incision time": "", "ischemic time": "", "laboratory internal id": "hSG-5", "laterality": "", "member of": "", "metadata only": "TRUE", "nCells": "4905", "nCount_ATAC": "15876.6799184506", "nCount_RNA": "4260.05626911315", "nFeature_ATAC": "6432.90948012232", "nFeature_RNA": "1823.30132517839", "number of directly derived samples": "", "pathology": "", "plane of section": "", "pool id": "", "post-mortem interval": "", "protein concentration": "", "protein concentration method": "", "protocol title": "", "protocol url or doi": "", "reference atlas": "", "sample anatomical location": "sympathetic ganglion", "sample collection site": "", "sample experimental group": "", "sample type": "tissue", "storage temp": "-80", "time of sample collection": "", "was derived from": ""}}, samples.Sample{ID: "sam-hSG-lib-6", SubjectID: "sub-hSG-Male-3", Values: map[string]string{"RNA concentration": "", "RNA concentration method": "", "RNA purity": "", "RNA quality": "", "RNA quality method": "", "also in dataset": "", "amputation": "not-asked", "body temp": "", "cell type": "", "collection institution": "WashU", "cross clamp (first)": "", "cross clamp (last)": "", "cross clamp time": "", "date of derivation": "", "donor status": "", "experimental log file path": "", "fixation method": "Fresh Frozen", "fixation temp": "-170", "fixation time": "", "freeze thaw cycles": "", "freezing method": "", "freezing temp": "", "incision time": "", "ischemic time": "", "laboratory internal id": "hSG-6", "laterality": "", "member of": "", "metadata only": "TRUE", "nCells": "4764", "nCount_ATAC": "12436.6511335013", "nCount_RNA": "4624.95046179681", "nFeature_ATAC": "5285.26994122586", "nFeature_RNA": "1936.36796809404", "number of directly derived samples": "", "pathology": "", "plane of section": "", "pool id": "", "post-mortem interval": "", "protein concentration": "", "protein concentration method": "", "protocol title": "", "protocol url or doi": "", "reference atlas": "", "sample anatomical location": "sympathetic ganglion", "sample collection site": "", "sample experimental group": "", "sample type": "tissue", "storage temp": "-80", "time of sample collection": "", "was derived from": ""}},
	samples.Sample{ID: "sam-D-20210629A-SG-CURLS-02", SubjectID: "sub-hSG-Male-4", Values: map[string]string{"RNA concentration": "", "RNA concentration method": "", "RNA purity": "", "RNA quality": "", "RNA quality method": "", "also in dataset": "", "amputation": "", "body temp": "", "cell type": "", "collection institution": "", "cross clamp (first)": "", "cross clamp (last)": "", "cross clamp time": "", "date of derivation": "", "donor status": "", "experimental log file path": "", "fixation method": "", "fixation temp": "", "fixation time": "", "freeze thaw cycles": "", "freezing method": "", "freezing temp": "", "incision time": "", "ischemic time": "", "laboratory internal id": "", "laterality": "", "member of": "", "metadata only": "TRUE", "nCells": "", "nCount_ATAC": "", "nCount_RNA": "", "nFeature_ATAC": "", "nFeature_RNA": "", "number of directly derived samples": "", "pathology": "", "plane of section": "", "pool id": "", "post-mortem interval": "", "protein concentration": "", "protein concentration method": "", "protocol title": "", "protocol url or doi": "", "reference atlas": "", "sample anatomical location": "sympathetic ganglion", "sample collection site": "", "sample experimental group": "", "sample type": "tissue", "storage temp": "", "time of sample collection": "", "was derived from": ""}},
	samples.Sample{ID: "sam-D-20220418A-SG-10A-CURLS-02", SubjectID: "sub-hSG-Male-5", Values: map[string]string{"RNA concentration": "", "RNA concentration method": "", "RNA purity": "", "RNA quality": "", "RNA quality method": "", "also in dataset": "", "amputation": "", "body temp": "", "cell type": "", "collection institution": "", "cross clamp (first)": "", "cross clamp (last)": "", "cross clamp time": "", "date of derivation": "", "donor status": "", "experimental log file path": "", "fixation method": "", "fixation temp": "", "fixation time": "", "freeze thaw cycles": "", "freezing method": "", "freezing temp": "", "incision time": "", "ischemic time": "", "laboratory internal id": "", "laterality": "", "member of": "", "metadata only": "TRUE", "nCells": "", "nCount_ATAC": "", "nCount_RNA": "", "nFeature_ATAC": "", "nFeature_RNA": "", "number of directly derived samples": "", "pathology": "", "plane of section": "", "pool id": "", "post-mortem interval": "", "protein concentration": "", "protein concentration method": "", "protocol title": "", "protocol url or doi": "", "reference atlas": "", "sample anatomical location": "sympathetic ganglion", "sample collection site": "", "sample experimental group": "", "sample type": "tissue", "storage temp": "", "time of sample collection": "", "was derived from": ""}}}

// expectedDataRowsCount is the expected number of non-header rows. One for each sample in consentedSubjectSamples
var expectedDataRowsCount = len(consentedSubjectSamples)
